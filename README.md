# Шпаргалка по работе с Git

## Оглавление
1. Инициализация каталога (init)
2. Добавление отслеживание файлом (add)
3. Создание контрольной точки (Сommit)
4. Генерация и установка SSH ключа (ssh-keygen)
5. Связываем локальный и удалённый репозиторий (remote add)
6. Синхронизация данных между локальным и удалённым серверами (push)
7. Просмотр журналов записей сделанных комитов (log)
8. Внесение изменений в созданный commit (commit --amend)
9. Откат изменений после команды *git add* (restore --staged)
11. Откат коммита (reset --hard)
12. Откат модифицированных данных(restore)
13. Изменения в файлах(diff)
14. Клонирование репозитория(clone)
15. Ветки(branch, merge, checkout, diff)
16. Pull request
17. Забираем изменения из удалённого репозитория(pull)
18. Слияние Fast-forward

## Инициализация каталога

Для инициализаци каталога используется команда:  
```
git init
```
Выполнение данной команды создает скрытый каталог **.git**, который отслеживает файлы в каталоге.

## Добавление файлов для отслеживания (add)

Если в каталоге создается файл, каталог и т.д. и выполнить команду:  
```
git status
```
можно увидеть, что с пометкой untracer красным цветом выделены файлы, котороые не отслеживаются.
Чтобы сделать файлы отслеживаемыми необходимо выполнить одну из следующуюих команд:  
```
1) git add <имя файла> - добавляет определённый файл

2) git add --all - добавляется все файлы репозитория

3) git add . - добавляет файлы из каталога
```
## Создание контрольной точки (Commit)

Надо заметить что add не выполняет функции контрольной точки, а только лишь сообщает Git,
 что файлы необходимо отслеживать.

Чтобы создать контрольную точку необходимо использовать команду:
```
git commit -m "<комментарий>"
```

## Генерация и установка SSH ключа

Для генерации SSH ключа необходимо выполнить следующую команду:
```
ssh-keygen <алгоритм шифрования> -С "<электронная почта аккаунта на GitHub>"
```
Данная команда создаст 2 файла в каталоге ./shh:
* <алгоритм шифрования>.pub - публичный ключ (можно давать кому угодно)
* <алгоритм шифрования> - приватный ключ (никому не давайте его)
При создании ключа ОС попросит придумать и ввести кодовую фразу для дополнительной защиты(можно 
пропусти нажав дважны "Enter"). Если вы создали фразу то при каждом ображении по протоколу SSH ОС 
будет запрашивать данную фразу, чтоыб подтвертить подлиность.

Копируем всё, что находится в файле <алгоритм шифрования>.pub.  
Далее заходим на свою страницу в GitHub и выполняем следующую последовательность действий:
- нажимаем на аватарку;
- в появившимся окне выбираем *Settings*;
- в наборе *Access* выбираем пункт *SSH and GPG keys*;
- спускаемся вниз и находим зелёную кнопку *New SSH key*;
- спускаемся вниз в поле *Title* указываем заголовок (как вариант можно указать имя ПК на котором
 находится приватный ключ);
- в поле *Key type* выбираем *Authentication Key*;
- в поле *Key* вставляем скопированый публичный ключ;
- нажимаем *Add SSH Key*.

проверить настройку по SSH можно с помощью команды:
```
ssh -T git@github.com
```

Так как это будет ваще первое соединение ОС предупреждает, что вы никогда с данным сервером не 
соединялись и поэтому она не может подтвердить подлинность данного сайта. Так же в этой строке 
будет передан ключ подлинности сайта проверить его можно [по этой ссылке](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/githubs-ssh-key-fingerprints).
Если все совпало, можно спокойно вводить *Yes*. В ответ на экране появится строка о том, 
что доступ разрешен. Соответсвенно ключ привязан к GitHub.

## Привязка локального репозитория к удалённому.
Изначально в репозитории на GitHub находим *<> Code* -> *Local* -> *SSH* и копируем строку,
которую предоставляет GitHub (шаблон строки: git@github.com:<имя пользователя>/<Имя репозитория>.git)
Для привязки выполняем следующую команду:
```
git remote add origin git@github.com:<имя пользователя>/<Имя репозитория>.git
```
Для проверки привязки модно выполнить команду:
```
git remote -v
```
в выводе данной команды будет 2 строки:
* origin git@github.com:<имя пользователя>/<Имя репозитория>.git (fetch)
* origin git@github.com:<имя пользователя>/<Имя репозитория>.git (push)

Соответсвенно локальный и уладённый репозитории связаны.

Чтобы удалить привязку репозитория необходимо выполнить команду
```
git remote rm origin
```

## Синхронизация между локальным и удалённым серверами

После создания контрольной точки, необходимо ее синхронизовать с удалённым сервером, для этого 
необходимо выполнить команду:
```
git push
```

Если данная команда выполняется в первый раз то ее необходимо связать с флагом **-u** и параметрами **main(master)**
командой:
```
git push -u origin main(если будет ошибка то master, зависит от имени главной ветки)
```
Флаг **-u** связывает локальную ветку с одноименной удалённой. 

## Просмотр журнальных записей(log), сделанных комитов (log)

Для вызова списка коммитов используется команда:  
```
git log
```
Данная команда по каждому коммиту выдает 4 строки:  
1. commit - строка из цифр и латинских букв, является хешом
2. Author - имя автора и его электронная почта
3. Date - дата и время создания коммита 
4. в конце находится комментарий коммита, которое вводили после флага **-m**

Так еж можно вызвать сокращенную версию лога с помощью команды:  
```
git log --oneline
```
Данная команда выводит в каждой строке небольшой кусок хеша и комментарий. Она
предназначена для вывода в том случае, если у вас уже много коммитов и искать
 определённый достаточно трудно.

Так же можно построить графф, это удобное если есть несколько веток и было сделано слияние
между ветками, для этого используется команда:
```
git log --graph --oneline
```
Для примера ответ будет выглядить следующи образом:

**   6814789 (HEAD -> main) Merge branch 'add-docs'  
|\  
| * e08fa2a (add-docs) New docs 2  
| * fd588b2 New docs 1  
|/  
** 997d9ce Commit 4  
** 0313e8e Commit 3  
** 5848aba Commit 2  
** 04923d7 Commit 1  

## Внесение изменений в созданный commit 

Если вам требуется изменить уже выполненный коммит, можно выполнить следующую
команду:
```
git commit --amend [{--no-edit}|{-m}|{}]
```
**--no-edit** - флаг, чтобы не менять сообщение коммита  
**-m** - изменить сообщение коммита  
**ничего не писать** - откроется nano или vim, чтобы изменить сообщение вручную

Важно понимать, что данная команда меняет только последний сделанный коммит.
Пример по шагам:
1. добавим и закоммитем файл *file_1.txt*  
```
git add file_1.txt
git commit -m "Add file_1.txt"
```
2. теперь необходимо создать file_2 и добавить его в созданный коммит
```
git add file_2.txt
git commit --amend -m "Add file_1.txt and file_2.txt"
```
теперь есть посмотреть лог, то можно увидеть, что колличество коммитов не
 уменьшилось

## Откат изменений после команды *git add*

Чтобы откатить изменения после добавления у отслеживанию т.е. **git add .**, 
требуется выполнить команду:
```
git restore --staged {[file_name]|[.]}
```
После выполнения команды *git add*, команда отмены пишется в подсказках.

## Откат коммита

Чтобы откатить коммит необходима команда:
```
git reset --hard <commit hash>
```
Данная команда откатывает коммит на тот хеш который вы выбрали из команды
*git log --oneline*. После отката хеш который вы выбрали станет главным, а последующие коммиты будут удалены. 
С данной командой нужно быть ОСТОРОЖНЫМ!

## Откат модифицированных данных

Данный случай лугче объяснить на примере.

Представь ситуацию, ты вставил данные не в тот файл и сохранил его. Чтобы его
откатить до предыдущего сохранённого состояния, необходимо выполнить команду:
```
git restore <file>
```

## Изменения в файлах

Если после изменения файла необходимо посмотреть, что **изменилось относительно закоммиченой версии**,
 нужно выполнить следующую команду:
```
git diff
```
красным и зеленым цветом будут выделены изменения что было и что стало соответсвенно.
Так же стрроки будут начитаться с символов "-" или "+", что обозначает удалённую строки
и доваленную.

Если необходимо посмотреть **изменения после команды "git add ..." **, то нужно 
выполнить следующую команду:
```
git diff --staged
```
Если необходимо посмотреть **изменения между коммитами** нужно выполнить 
слудующую команду:
```
git diff <хеш стартовой позиции> <хеш конечной позиции>
```
По сути данная команда выводить какие изменение сделаны(нужно сделать), 
чтобы прейти из стартовой позиции в конечную. 

## Клонирование репозитория

Для клонирования репозитория используется следующая команда:
```
git clone [{HTTPS}|{SSH}|{GitHub CLI}]
```
[{HTTPS}|{SSH}|{GitHub CLI}] - данные ссылки находятся на странице репозитория 
во вкладке **<> Code** (кнопка выделена зелёным цветом)

Так же можно клонировать репозиторий на прямую в GitHub с помощью **Fork**.
Это необходимо чтобы при внесениии изменений в проект закоммитеть его. Чтобы
 это сделать на главной странице чужого репозитория нажмите **Fork** 
(правый верхний угол). Далее будет переход на страницу создания репозитория,
создаем его и ждём когда все скопируется.

## Ветки

Для создания новой ветки используется команда:
```
git branch <название ветки>
```

Чтобы получить список веток, необходимо выполникть комаду:
```
git branch
```
команда для переключения между ветками:
```
git checkout <название ветки>
```

Если нужно создать ветку и тут же на нее переключиться, делается это командой:
```
git chrackout -b <название ветки>
```

Чтобы узнать изменение между ветками используется команда:
```
git diff [{название ветки}|{хеш ветки}|{название ветки~кол-во шагов назад от последнего коммита}][{название ветки}|{хеш ветки}|{название ветки~кол-во шагов назад от последнего коммита}]
```

Чтобы объединить ветки используется команда:
```
git merge <название ветки>
```
Перед оюъединением веток, необходимо перейти на ветку в которую будет происходить 
слияние.

Чтобы удалить ветку можно использовать следующие команды:
```
git branch -D <название ветки>
```

```
git branch -d <название ветки>
```

Разница состоит в том, что 2я не даст удалить ветку пока не будет произведено
слияние, соответсвенно удаление будет происходить безопаснее.

Push ветки в GitHub делается следующим образом. Если ветки нет в GitHub 
необходимо выполнить следующую команду:
```
git push -u origin <название ветки>
```
Именно эта команда привязывает ветку к репозиторию в GitHub, последующие команды 
из данный ветки будут выглядить следующим образом:
```
git push
```
## Pull request

После выполнения **git push** необходимо зайти в репозиторий GitHub, далее в верхней части
нужно выбирать вкладку **Pull requests**, далее необходимо нажать на зелёную кнопку 
**New pull request**. В верхней части есть 2 вствывающих окна "base" и "compare", эти окна обозначают
из какой ветки в кукую необходимо выполнить pull request, соответсвенно необходимо выбрать нужные 
ветки и нажать на зелёную кнопку **Create pull request**, заполняем заголовок и описание и 
необходимо нажать на зелёную кнопку **Create pull request**. Теперь создан "Pull request",
 который могут комментировать другие пользователи. После исправления всех недочетов нажимаем на 
зелёную кнопку **Merge pull request** и соответственно изменения подадут в ветку, которая находилась
в окне **base**.

 
## Забираем изменения из удалённого репозитория

Чтобы забрать данные из удалённого репозитория необходимо выполнить команду:
```
git pull
```

Хорошим тоном является выполнение данной команды как только возобновили работу с проетом и
перед тем как произвести слияние своей ветки с общей через команду "git merge".

## Слияние Fast-forward

Слияние Fast-forward является самым простым видом слияния веток. По сути оно является продолжением
ветки, т.е. после слияния будут выглядить как обычные коммиты и в логе не будет информации о
ветке из которой брали данные. 

В общем и целом на проектах Fast-forward отключают "навсегда" с помощью команды:
```
git config [--global] merge.ff false
```
После отключения Git будет использовать медот *merge commit* 

Так же отключить Fast-forward можно и в команде "merge":
```
git merge --no-edit --no-ff <ветка слияния>
```

